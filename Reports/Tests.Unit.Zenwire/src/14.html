<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\projects\zenwire\zenwire\controllers\referralcontroller.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Zenwire.Domain;
using Zenwire.Models;
using Zenwire.Repositories;
using Zenwire.Services;

namespace Zenwire.Controllers
{
    public class ReferralController : Controller
    {
        private readonly IReferralService _referralService;
        private readonly IEmployeeService _employeeService;
        private readonly ICustomerService _customerService;
        private readonly IProductService  _productService;

        public ReferralController(IReferralService referralService, IProductService productService, ICustomerService customerService, IEmployeeService employeeService)
        {
            _productService = productService;
            _customerService = customerService;
            _employeeService = employeeService;
            _referralService = referralService;
        }

        public ReferralController()
        {
            
        }

        // GET: /Referral/
        public ActionResult Index()
        {
            var referrals = _referralService.Get().ToList();
            return View(referrals);
        }

        //
        // GET: /Referral/Details/5

        public ActionResult Details(int id = 0)
        {
            Referral referral = _referralService.Get(id);
            if (referral == null)
            {
                return HttpNotFound();
            }
            return View(referral);
        }

        //
        // GET: /Referral/Create

        public ActionResult Create()
        {
            return View(new ReferralModel()
            {
                Customers = _customerService.Get(),
                Products = _productService.Get(),
                Employees = _employeeService.Get(),
                Referral = new Referral()
            });
        }

        //
        // POST: /Referral/Create

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(ReferralModel model)
        {
            if (ModelState.IsValid)
            {
                _referralService.Add(model.Referral);
                return RedirectToAction(&quot;Index&quot;);
            }

            return View(model);
        }

        //
        // GET: /Referral/Edit/5

        public ActionResult Edit(int id = 0)
        {
            Referral referral = _referralService.Get(id);
            if (referral == null)
            {
                return HttpNotFound();
            }

            return View(referral);
        }

        //
        // POST: /Referral/Edit/5

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(Referral referral)
        {
            if (ModelState.IsValid)
            {
                _referralService.Update(referral);
                return RedirectToAction(&quot;Index&quot;);
            }

            return View(referral);
        }

        //
        // GET: /Referral/Delete/5

        public ActionResult Delete(int id = 0)
        {
            Referral referral = _referralService.Get(id);
            if (referral == null)
            {
                return HttpNotFound();
            }
            return View(referral);
        }

        //
        // POST: /Referral/Delete/5

        [HttpPost, ActionName(&quot;Delete&quot;)]
        [ValidateAntiForgeryToken]
        public ActionResult DeleteConfirmed(int id)
        {
            _referralService.Remove(id);
            return RedirectToAction(&quot;Index&quot;);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,22,168,0],[23,9,23,10,0],[24,13,24,46,0],[25,13,25,48,0],[26,13,26,48,0],[27,13,27,48,0],[28,9,28,10,0],[30,9,30,36,0],[31,9,31,10,0],[33,9,33,10,0],[37,9,37,10,0],[38,13,38,61,0],[39,13,39,36,0],[40,9,40,10,0],[46,9,46,10,0],[47,13,47,58,0],[48,13,48,34,0],[49,13,49,14,0],[50,17,50,39,0],[52,13,52,35,0],[53,9,53,10,0],[59,9,59,10,0],[60,13,66,16,0],[67,9,67,10,0],[75,9,75,10,0],[76,13,76,36,0],[77,13,77,14,0],[78,17,78,54,0],[79,17,79,50,0],[82,13,82,32,0],[83,9,83,10,0],[89,9,89,10,0],[90,13,90,58,0],[91,13,91,34,0],[92,13,92,14,0],[93,17,93,39,0],[96,13,96,35,0],[97,9,97,10,0],[105,9,105,10,0],[106,13,106,36,0],[107,13,107,14,0],[108,17,108,51,0],[109,17,109,50,0],[112,13,112,35,0],[113,9,113,10,0],[119,9,119,10,0],[120,13,120,58,0],[121,13,121,34,0],[122,13,122,14,0],[123,17,123,39,0],[125,13,125,35,0],[126,9,126,10,0],[134,9,134,10,0],[135,13,135,41,0],[136,13,136,46,0],[137,9,137,10,0]]);
    </script>
  </body>
</html>